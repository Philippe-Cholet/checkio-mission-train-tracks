<!-- Describe task in general -->
<p>
    This mission is an adaptation of the "Tracks" game (from
    <a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/">
    Simon Tatham's Portable Puzzle Collection</a>).
    If you are lost or just want to play, the game is available
    <a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/tracks.html">here</a>.
</p>

<p>
    You have to trace train tracks from "start" to "end"
    in a rectangular grid, respecting constraints:
    <ul>
        <li>Each row and column must contain a given number of tracks.</li>
        <li>
            Some tracks are fixed and you must use them as they are.
            Their positions are given with the entry / exit directions
            (North / South / West / East). You can choose the entry.
        </li>
        <li>The exit direction of the start,
        and the entry direction of the end are fixed.</li>
        <li>The track may not cross itself.</li>
    </ul>
    You will have to return how you moves from start to end
    with North / South / West / East directions.
</p>


<!-- Representations -->
<p>
    <ul>
        <li>Rows (and columns) count constraints will be represented by a list of integers.</li>
        <li>Start (and end) will be represented by its coordinates, a tuple of two integers.</li>
        <li>
            Fixed tracks will be represented by a dictionary
            with coordinates (tuple of two integers) as keys
            and set of entry / exit directions as values.
        </li>
    </ul>
    <strong>Note:</strong>
    <code>(len(rows), len(columns))</code> give the grid dimensions.
</p>


<!-- Explain input and output values -->
<p>
    <strong>Input:</strong>
    Two lists of integers,
    two tuples of two integers
    and a dictionary
    (keys: tuples of two integers ;
     values: set of one or two strings).
</p>

<p>
    <strong>Output:</strong>
    A string.
</p>


<!-- Put some usage examples -->
<div class="for_info_only">
<p>
    <strong>Example:</strong>
</p>

<!-- First test explained -->
<pre style="text-align:center">
<img src="{{MEDIA}}basic-example-1.png" alt="8x8 example image" title="8x8 basic example"/>
Your moves from (3, 0) to (7, 6): "NNNESESEENENESSSESSWWSWWSEEE".
</pre>

<pre class="brush: python">
train_tracks([4, 6, 5, 3, 1, 3, 3, 4],  # rows
             [4, 2, 2, 3, 4, 5, 6, 3],  # columns
             (3, 0),                    # start
             (7, 6),                    # end
             {(3, 0): {'N'},            # constraints
              (4, 7): {'N', 'S'},
              (6, 4): {'E', 'W'},
              (7, 6): {'W'}},
             ) == 'NNNESESEENENESSSESSWWSWWSEEE'
</pre>

<p>
    To play the puzzles / tests yourself:
    <a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/tracks.html#8x8:x6nAl5iCa,4,2,2,3,4,5,S6,3,4,6,5,S3,1,3,3,4" title="8 rows, 8 columns">1</a>
    <a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/tracks.html#8x8:j5c6i5zhCd,3,6,7,S5,4,3,6,6,8,7,7,S5,5,3,2,3" title="8 rows, 8 columns">2</a>
    <a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/tracks.html#10x8:m3p6n3j9qAc5a,3,2,3,4,S6,6,5,5,5,2,6,7,5,S6,4,3,6,4" title="8 rows, 10 columns">3</a>
    <a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/tracks.html#10x10:j6s9nCpCa95q5k9d,5,4,7,8,7,S6,7,4,4,8,6,S5,7,7,5,7,7,8,5,3" title="10 rows, 10 columns">4</a>
    <a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/tracks.html#15x10:kCc6jAf5d95kCrCa5h9p6zn9j,2,1,3,1,S2,4,6,4,4,5,6,6,3,3,3,6,S5,11,7,8,6,5,1,2,2" title="10 rows, 15 columns">5</a>
    <a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/tracks.html#15x15:g9Cf3zcAb9a3a3h9CzaAzy5Cs5a5c6d56fCzh9g,10,10,9,11,7,5,5,S6,9,7,4,4,2,2,2,9,6,8,7,4,4,4,3,6,14,8,S8,6,4,2" title="15 rows, 15 columns">6</a>
    <a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/tracks.html#10x20:p6gAe5d9f9bAyCn6dCi3gAhCzc3g5d3x6jCb,5,12,7,7,9,15,13,S12,5,7,3,3,3,S5,7,5,7,5,7,6,4,3,5,9,3,4,6,2,2,3" title="20 rows, 10 columns">7</a>
    <a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/tracks.html#10x20:j6d6b9c9e3sAm6cChCc6g3c363e6m9kAaAnAc6gCk5s5i9c,8,10,11,10,11,14,S11,10,11,9,7,S7,5,6,3,5,7,9,10,8,3,5,5,6,4,3,4,3,3,2" title="20 rows, 10 columns">8</a>
    <a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/tracks.html#15x25:5kChAa3Cg3i5Cx6c5e5b5p5d56k3eCf5e9dCbCfAaCf3l3h6o9mAqAc5j3aAwAb3oCn6l3zs9k,10,12,17,S18,17,8,13,11,11,12,15,11,9,7,3,S9,9,10,9,10,9,13,8,10,14,10,7,5,5,6,6,5,5,5,7,3,3,2,2,2" title="25 rows, 15 columns">9</a>
    <a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/tracks.html#20x20:i5b5e5jCq6f3rAcAAuCg3lAk6hAfCp9b3cCl3rAd96m36uA35zzi3qAd5p9o3w5aAe,4,5,5,3,3,6,7,7,10,17,12,12,12,13,S8,5,4,5,4,3,15,11,9,4,8,S9,8,9,12,8,7,6,4,2,3,8,5,6,7,4" title="20 rows, 20 columns">10</a>
    <a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/tracks.html#30x30:rCs3Ca6iCo3aAa5tAzi5mAg6dAzc6Azu6v9cAc5w5zg5z6d9zeCz3u6d3zg9zzy9h6b3s6y3i3a9a3q3zzzl3zbCzeCAb6zy6x9w,6,3,5,5,3,4,S8,6,6,6,6,9,4,11,8,10,8,11,10,10,5,12,13,7,11,12,9,5,3,3,14,14,16,10,13,S8,4,7,7,7,10,7,9,8,6,4,3,3,7,8,9,7,4,5,5,7,7,3,5,2" title="30 rows, 30 columns">11</a>
    <a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/tracks.html#45x35:i5zi6c5Ca3b5zt5bCzi5555e3zl5zn3C3zqAb5zn6c9b9zs95zg69d5zu3h9xAv556zs5t5m6zbAa5pAzwAb5zh3b5a9bAeCzzzoCzzzzzbAzl9fAzk6c9bAa3zoAzu3c6zi9g9zzzzzzrCc36zg3g9fAzi5d5a3zzzkAa6,2,7,8,7,12,8,7,8,9,9,9,7,7,6,6,5,10,3,2,1,5,5,4,3,5,7,6,6,8,11,10,4,11,10,14,13,8,7,7,4,7,6,S8,7,7,10,S10,11,11,8,8,8,11,9,14,10,13,10,9,8,13,13,6,4,3,1,3,6,10,12,13,9,3,10,14,17,12,11,3,3" title="35 rows, 45 columns">12</a>
    <a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/tracks.html#40x40:e5a9zf3aA3mCzdAze5cAi3zkAzdAm5zh5aAa55zzzzzz5zn5zzzbCzk3a3aAzzw9dAzzzzl5zk9CbCzg5aAfCzk6zg3c5bCa6zfCdAzi9zk3zzyCa5i6zfCdCl35y6c9b3d6y3bAgAc96p3zzdAzzzzoChCzb3c3c9zm3zfAj,3,4,5,5,7,3,2,2,5,4,2,9,13,16,24,27,29,18,12,7,6,7,8,11,5,1,3,1,4,S6,7,6,6,4,5,6,7,9,4,3,10,12,11,S13,12,10,10,3,1,2,3,4,5,4,5,5,4,6,3,7,6,12,9,10,4,10,6,7,12,11,17,13,15,7,3,5,11,10,5,3" title="40 rows, 40 columns">13</a>
    <a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/tracks.html#50x50:a5zxCzxAhAzk5i3zq5hCzk9zy3f36zuAzzb5zs6e5zlCa69dAa5zm6zuAg5zzzzzzzp6zx3zzzzfCzu3zx9zzzzzs5s9zc55zzn3dAzcCkAa6zg3wCzbAzr9b5aAzzp6aAAzk3bAdCzyCx6a5c5e6pAwCuCcAt3f9tCzeAq3za6c6zzzzmAzAzzcAo3zyAx5hCbCa63bCznAd5bCzvCb3c5y3CaAzwAj555zj3a9s3a,3,6,6,14,7,5,6,4,5,11,10,13,13,7,4,4,3,5,1,3,11,11,17,16,10,15,7,8,S6,8,8,5,3,5,5,3,12,11,13,8,6,8,5,7,12,9,9,9,13,13,4,6,6,S6,6,10,8,7,10,13,15,8,8,3,1,3,3,7,1,6,3,2,3,1,8,9,10,7,8,4,11,13,14,10,19,13,13,10,6,4,3,5,5,7,17,13,20,15,13,6" title="50 rows, 50 columns">14</a>
    <a href="https://www.chiark.greenend.org.uk/~sgtatham/puzzles/js/tracks.html#50x50:zf9zy3fAzn9zzfCzw3zm9l3zh9Czq9b9sCzg3zq3b6rCzCv36yA3zt9zwAzCzrAzAa3zzzzzs6r5zbArAzb9CaAdCm9xCcAt6s9b6e6yAk5CaAm6zc6c6b3hAe95g9b55eCl9k356f63bCe9rAzd3a95i3y96aCAzuCAa9t3Czzt3za6zaAvCzw6zg5zy5zpAaCcCzzdCf3zbArAb5cC9za3p5zpCc55zeCpCh3c3Czzo9zd6zkAd3d3zrCa5zrCzzzzzzzCh,4,5,1,3,8,13,17,13,12,12,7,9,7,6,7,5,6,7,5,6,4,11,10,12,10,12,5,10,5,9,9,10,13,13,6,8,10,16,14,9,14,S16,14,8,12,11,14,5,5,6,8,7,4,4,5,6,6,11,9,9,8,5,5,7,10,4,2,6,10,9,11,15,12,19,24,22,22,13,8,9,5,6,7,10,7,6,8,S10,15,15,13,8,10,7,9,12,7,5,1,3" title="50 rows, 50 columns">15</a>
</p>
</div>


<p>
    <strong>Preconditions:</strong>
    <ul>
        <li>All puzzles are solvable.</li>
        <li>8 &le; len(rows) &le; 50 and 8 &le; len(columns) &le; 50.</li>
        <li>len(constraints[start]) == 1 == len(constraints[end])</li>
        <li>all(0 &le; row &lt; len(rows) and 0 &le; col &lt; len(columns)
                for row, col in constraints)</li>
        <li>all(value &le; {'E', 'N', 'S', 'W'} and 1 &le; len(value) &le; 2
                for value in constraints.values())</li>
        <li>{value for value in constraints.values() if len(value) == 1} == {start, end}</li>
    </ul>
</p>
